<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog
       xmlns="http://www.liquibase.org/xml/ns/dbchangelog"  
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"  
xmlns:pro="http://www.liquibase.org/xml/ns/pro"					
xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.1.xsd
http://www.liquibase.org/xml/ns/pro 
http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.1.xsd">
	<changeSet  author="ben-malik (generated)" id="143924258004343e29-malik-MI-1343e910-154">
        <!-- createTable tableName="user">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints primaryKey="true"/>
            </column>
            <column name="password" type="varchar(255)"/>
            <column name="username" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="surname" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="email" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
             <column name="address_id" type="BIGINT">
            <constraints nullable="false" foreignKeyName="fk_user_address" references="address(id)"/>
          </column>
        </createTable>
        <createTable tableName="address">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints primaryKey="true"/>
            </column>
            <column name="street_address" type="varchar(255)"/>
            <column name="city" type="varchar(255)">
            </column>
            <column name="country" type="varchar(255)">
            </column>
            <column name="zip_code" type="varchar(255)">
            </column>
        </createTable>
         <createTable tableName="user_role">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints primaryKey="true"/>
            </column>   
           <column name="role_id" type="BIGINT">
            <constraints nullable="false" foreignKeyName="fk_role_user_role" references="role(id)"/>
          </column>
           <column name="user_id" type="BIGINT">
            <constraints nullable="false" foreignKeyName="fk_user_user_role" references="app_user(id)"/>
          </column>
        </createTable>
         <createTable tableName="role">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" type="varchar(255)"/>
   
           <column name="user_role_id" type="BIGINT">
            <constraints nullable="false" foreignKeyName="fk_role_user_role" references="user_role(id)"/>
          </column>
        </createTable>
        
        
         
         <createTable tableName="PRODUCT">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints primaryKey="true"/>
            </column>
            <column name="NAME" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="CODE" type="varchar(5)">
                <constraints nullable="false"/>
            </column>
            <column name="DESCRIPTION" type="varchar(255)"/>
           
            <column name="PRICE" type="FLOAT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="ben-malik" id="addColumn-for-count"> 
	<addColumn 
			tableName="PRODUCT" >
		<column name="COUNT" 
			type="INTEGER">
			<constraints nullable="false"/>
		</column>  
		
	</addColumn>  
	
	</changeSet>
	<changeSet id="add-box-code" author="ben-malik">
		<addColumn 
			tableName="PRODUCT" >
		<column name="BOX_CODE" 
			type="VARCHAR(10)">
			<constraints nullable="true"/>
		</column>  
		
	</addColumn> 
	<addColumn tableName="user">
		 <column name="address_id" type="BIGINT">
            <constraints nullable="false" foreignKeyName="fk_user_address" references="address(id)"/>
          </column>
	</addColumn>
	<renameColumn  
            columnDataType="varchar(255)"  
            newColumnName="firstname"  
            oldColumnName="name"  
            remarks="A String"  
            schemaName="public"  
            tableName="user"/> 
            
            <createTable tableName="user_role">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints primaryKey="true"/>
            </column>   
           <column name="role_id" type="BIGINT">
            <constraints nullable="false" foreignKeyName="fk_role_user_role" references="role(role_id)"/>
          </column>
           <column name="user_id" type="BIGINT">
            <constraints nullable="false" foreignKeyName="fk_user_user_role" references="user(id)"/>
          </column>
        </createTable>
	 -->
	  
        
         

	</changeSet>
	
	<changeSet id="232453-5344" author="benmalik">
		 <createTable tableName="category">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints primaryKey="true" primaryKeyName="categoryPK"/>
            </column>
            <column name="name" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
	</changeSet>
	<changeSet id="12134434-34443" author="benmalik">
		<createTable tableName="product">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints primaryKey="true" primaryKeyName="productPK"/>
            </column>
            <column name="name" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="code" type="varchar(5)">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="varchar(255)"/>
           
            <column name="price" type="FLOAT">
                <constraints nullable="false"/>
            </column>
            <column name="BOX_CODE" type="VARCHAR(10)">
				<constraints nullable="true"/>
			</column>  
			<column name="COUNT" type="INTEGER">
				<constraints nullable="false"/>
			</column>
			<column name="brand_id" type="BIGINT">
            	<constraints nullable="true" foreignKeyName="fk_brand_product" references="brand(id)"/>
          	</column>
        </createTable>
	</changeSet>
	
	<changeSet id="2345-243443" author="benmalik">
		<createTable tableName="product_category">
			<column name="product_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="category_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
		</createTable>
	</changeSet>
	<changeSet author="benmalik" id="15507404134906-6">
        <addPrimaryKey columnNames="product_id, category_id" tableName="product_category"/>
    </changeSet>
    <changeSet author="benmalik" id="15540740413906-8">
        <addForeignKeyConstraint baseColumnNames="product_id" baseTableName="product_category"
                                 constraintName="FK_apcc8lxk2xnug8377fatvbn04" deferrable="false"
                                 initiallyDeferred="false" referencedColumnNames="id" referencedTableName="product"/>
    </changeSet>
    <changeSet author="benmalik" id="1550740413343906-9">
        <addForeignKeyConstraint baseColumnNames="category_id" baseTableName="product_category"
                                 constraintName="FK_it77eq964jhfqtu54081ebtio" deferrable="false"
                                 initiallyDeferred="false" referencedColumnNames="id" referencedTableName="category"/>
    </changeSet>
	<!-- 
		<changeSet id="create-category-and-brand-for-product-1" author="ben-malik">
		        
        <createTable tableName="brand">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
			
          	<column name="product_id" type="BIGINT">
            	<constraints nullable="false" foreignKeyName="fk_product_brand" references="product(id)"/>
          	</column>
        </createTable>
        
         <createTable tableName="category">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
          	<column name="product_id" type="BIGINT">
            	<constraints nullable="false" foreignKeyName="fk_product_category" references="product(id)"/>
          	</column>
        </createTable>
	</changeSet>
	-->
 
	        <!-- 

	<changeSet id="add-image-column0-4144764" author="ben-malik">

         
		 <addColumn tableName="product">
		 <column name="picture" type="varchar(255)"/>
	</addColumn>
	</changeSet>
	 	
	<changeSet id="add-category-foreign-key-toproduct94" author="ben-malik">
		<addColumn tableName="product"> 
		 <column name="brand_id" type="BIGINT">
            <constraints nullable="true" foreignKeyName="fk_brand_product" references="brand(id)"/>
          </column></addColumn>
	</changeSet>
	-->
</databaseChangeLog>